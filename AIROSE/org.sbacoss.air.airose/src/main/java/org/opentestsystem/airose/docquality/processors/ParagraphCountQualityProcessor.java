/*******************************************************************************
 * Copyright (c) 2013 American Institutes for Research
 * 
 * This file is part of AIROSE.
 * 
 * AIROSE is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 * 
 * AIROSE is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with AIROSE.  If not, see <http://www.gnu.org/licenses/>.
 ******************************************************************************/
package org.opentestsystem.airose.docquality.processors;

import java.util.ArrayList;

import org.apache.commons.lang.StringUtils;
import org.opentestsystem.airose.common.abstractdocument.AbstractDocument;
import org.opentestsystem.airose.db.entities.DocumentQuality;
import org.opentestsystem.airose.docquality.EnumDocumentQualityAttributes;

public class ParagraphCountQualityProcessor extends AbstractDocumentQualityProcessor
{

  public ParagraphCountQualityProcessor (DocumentQuality quality) {
    super (quality);
    // TODO Auto-generated constructor stub
  }

  @Override
  public double assignQualityWeight (AbstractDocument doc) {
    String[] paragraphs = getParagraphs (doc.getOriginalResponse ());
    if (paragraphs == null)
      return 0;
    return paragraphs.length;
  }

  @Override
  public EnumDocumentQualityAttributes getDocumentQualityAttributeType () {
    return EnumDocumentQualityAttributes.PARAGRAPH_COUNT;
  }

  protected ParagraphCountQualityProcessor () {
    super (null);
  }

  private static String[] getParagraphs (String st) {
    final String REGEX = "   |\r\t|\n\t|\r\n|\n\r|\r|\n|\n\n|\r\r";
    String[] newSt = st.split (REGEX);
    ArrayList<String> returnList = new ArrayList<String> ();
    for (int counter1 = 0; counter1 < newSt.length; ++counter1)
      if (!StringUtils.isEmpty (newSt[counter1]))
        returnList.add (newSt[counter1]);
    if (returnList.size () == 0)
      return null;
    return returnList.toArray (new String[returnList.size ()]);
  }

  public static void main (String[] argv) {
    String value = "i would what to live in the southwest.i would what live there   because,it would to live somewhere a little colse to where i live.";
    System.err.println (2 == getParagraphs (value).length);

    value = "I would like to live in the Southeast. because of the beaches and summer so I can relax on the beach ,and from the story it says that the regon in the winter is mild. It also says if you dont like the cold this regon is for you so I would like to live in the Southeast. Also I like it humid in the summers it says in the story that summers are humid. It says in the story that you can watch the leavs turn in the fall on Blue Ridge mountins and I have never been on a mountin before.         It would be fun to live in a big vacation area. Going to the beach in this regon would be great. I love to swim espesaly in the ocean and the beach is a great place to explore with friends.        I would love to relax in the mountins to explore wiled life and get to know nature and all the animals in it. I would also like to go camping on the mountins of Blue Ridge.        In the north east you can go sking and snow boarding and you can see historical sites.        In the south west you can see the Grand Canyon and many other things.         In the mid west you can grow lots of things and explor all over.      in tghe west you can go out side and love the nature and animals and go to the beach of califorina and go to the mountins.";
    System.err.println (7 == getParagraphs (value).length);

    value = "I would like to live in the Southeast region because I do not like the cold and I like to play in the waves of the ocean. I would also like to live in the Southeast region because I was born there and I always liked the weather and the tempurture. But the most important reson is because I want to go to a good university and have a good job.    For along time I have been thinking about going to California or Florida for collage but I want to go to Florida more even though I have relatives in California that I can go vist every week. I want to go to Florida more because there is more peruvian restorants and they have my favorite drink Inka Cola.";
    System.err.println (2 == getParagraphs (value).length);

  }
}
